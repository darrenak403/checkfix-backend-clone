<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/api-gataway/API_GATEWAY_README.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/api-gataway/API_GATEWAY_README.md" />
              <option name="updatedContent" value="# API Gateway Documentation&#10;&#10;## Overview&#10;This API Gateway serves as the single entry point for all microservices in the HCM CPL Java Group 2 project. It provides routing, authentication, rate limiting, circuit breaking, and monitoring capabilities.&#10;&#10;## Architecture&#10;&#10;### Services&#10;- **API Gateway**: Port 8080 (Entry point)&#10;- **IAM Service**: Port 8081 (Authentication &amp; User Management)&#10;- **Patient Service**: Port 8082 (Patient Management)&#10;&#10;### Key Features&#10;1. **JWT Authentication**: Validates JWT tokens for protected endpoints&#10;2. **Rate Limiting**: Prevents API abuse (100 requests/minute per user)&#10;3. **Circuit Breaker**: Provides fallback when services are unavailable&#10;4. **CORS Support**: Handles cross-origin requests&#10;5. **Global Exception Handling**: Consistent error responses&#10;6. **Health Monitoring**: Actuator endpoints for monitoring&#10;&#10;## API Routes&#10;&#10;### Authentication Routes (IAM Service)&#10;```&#10;POST /api/auth/login           - User login&#10;POST /api/auth/register        - User registration  &#10;POST /api/auth/refresh-token   - Refresh JWT token&#10;GET  /api/auth/social/**       - Social authentication&#10;POST /api/password-reset/**    - Password reset&#10;GET  /api/users/**            - User management (protected)&#10;```&#10;&#10;### Patient Management Routes (Patient Service)&#10;```&#10;GET    /api/patients/**           - Patient operations (protected)&#10;POST   /api/patients/**           - Create patient (protected)&#10;PUT    /api/patients/**           - Update patient (protected)&#10;DELETE /api/patients/**           - Delete patient (protected)&#10;GET    /api/appointments/**       - Appointment operations (protected)&#10;POST   /api/appointments/**       - Create appointment (protected)&#10;GET    /api/medical-records/**    - Medical records (protected)&#10;POST   /api/medical-records/**    - Create medical record (protected)&#10;```&#10;&#10;### Gateway Management Routes&#10;```&#10;GET /health                    - Gateway health check&#10;GET /health/gateway           - Gateway status with routes&#10;GET /actuator/health          - Detailed health information&#10;GET /actuator/gateway/routes  - View all configured routes&#10;```&#10;&#10;## Authentication&#10;&#10;### Protected Endpoints&#10;All endpoints except the following require JWT authentication:&#10;- `/api/auth/login`&#10;- `/api/auth/register`&#10;- `/api/auth/refresh-token`&#10;- `/api/auth/social/**`&#10;- `/api/password-reset/**`&#10;- `/actuator/**`&#10;- `/health/**`&#10;&#10;### JWT Token Usage&#10;Include JWT token in the Authorization header:&#10;```&#10;Authorization: Bearer &lt;your-jwt-token&gt;&#10;```&#10;&#10;The gateway will validate the token and forward user information to downstream services via headers:&#10;- `X-User-Id`: User ID from JWT&#10;- `X-User-Email`: User email from JWT&#10;- `X-User-Role`: User role from JWT&#10;&#10;## Rate Limiting&#10;- **Default**: 100 requests per minute per user/IP&#10;- **Burst Capacity**: 200 requests&#10;- **Rate limit exceeded**: HTTP 429 Too Many Requests&#10;&#10;## Circuit Breaker&#10;- **Failure Threshold**: 50% failure rate&#10;- **Minimum Calls**: 5 calls before evaluation&#10;- **Open State Duration**: 5 seconds&#10;- **Half-Open Calls**: 3 calls allowed in half-open state&#10;&#10;When a service is unavailable, fallback endpoints provide graceful error responses.&#10;&#10;## CORS Configuration&#10;- **Allowed Origins**: All origins (configurable)&#10;- **Allowed Methods**: GET, POST, PUT, DELETE, OPTIONS&#10;- **Allowed Headers**: All headers&#10;- **Credentials**: Supported&#10;&#10;## Monitoring&#10;&#10;### Health Checks&#10;- `/health` - Basic gateway health&#10;- `/actuator/health` - Detailed health with circuit breaker status&#10;- `/actuator/metrics` - Application metrics&#10;- `/actuator/gateway/routes` - Active routes&#10;&#10;### Logging&#10;Debug logging is enabled for:&#10;- Gateway routing decisions&#10;- CORS handling&#10;- Authentication filters&#10;- Circuit breaker events&#10;&#10;## Running the Services&#10;&#10;### Prerequisites&#10;- Java 21&#10;- MySQL database running on localhost:3306&#10;- Database: `lab_manager`&#10;&#10;### Start Order&#10;1. **Database**: Ensure MySQL is running&#10;2. **IAM Service**: `mvn spring-boot:run` (Port 8081)&#10;3. **Patient Service**: `mvn spring-boot:run` (Port 8082)  &#10;4. **API Gateway**: `mvn spring-boot:run` (Port 8080)&#10;&#10;### Environment Variables&#10;```bash&#10;# JWT Configuration&#10;JWT_SECRET=nXT5iZ/lPUY/9T4pgt3zqCJkezyP0if70mQbfJlz1k8=&#10;&#10;# Database Configuration&#10;DB_URL=jdbc:mysql://localhost:3306/lab_manager&#10;DB_USERNAME=root&#10;DB_PASSWORD=123456&#10;```&#10;&#10;## Testing&#10;&#10;### Health Check&#10;```bash&#10;curl http://localhost:8080/health&#10;```&#10;&#10;### Authentication Test&#10;```bash&#10;# Login&#10;curl -X POST http://localhost:8080/api/auth/login \&#10;  -H &quot;Content-Type: application/json&quot; \&#10;  -d '{&quot;email&quot;:&quot;user@example.com&quot;,&quot;password&quot;:&quot;password&quot;}'&#10;&#10;# Use protected endpoint&#10;curl -X GET http://localhost:8080/api/users/profile \&#10;  -H &quot;Authorization: Bearer &lt;your-jwt-token&gt;&quot;&#10;```&#10;&#10;### Rate Limiting Test&#10;```bash&#10;# Make multiple rapid requests to test rate limiting&#10;for i in {1..150}; do curl http://localhost:8080/api/users/profile; done&#10;```&#10;&#10;## Security Considerations&#10;&#10;1. **JWT Secret**: Change the default JWT secret in production&#10;2. **CORS**: Restrict allowed origins in production&#10;3. **Rate Limiting**: Adjust limits based on expected traffic&#10;4. **HTTPS**: Use HTTPS in production environments&#10;5. **Firewall**: Restrict direct access to backend services&#10;&#10;## Troubleshooting&#10;&#10;### Common Issues&#10;&#10;1. **Port Conflicts**: Ensure each service runs on different ports&#10;2. **Database Connection**: Verify MySQL is running and accessible&#10;3. **JWT Validation**: Check JWT secret matches across services&#10;4. **Service Discovery**: Ensure backend services are accessible&#10;&#10;### Log Locations&#10;- Gateway logs: Check console output or configured log files&#10;- Service-specific logs: Check individual service logs&#10;&#10;### Debug Mode&#10;Enable debug logging by setting:&#10;```yaml&#10;logging:&#10;  level:&#10;    com.datnguyen.pe.apigataway: DEBUG&#10;```&#10;&#10;## Production Deployment&#10;&#10;### Recommendations&#10;1. Use environment-specific configuration files&#10;2. Implement proper logging and monitoring&#10;3. Set up load balancing for multiple gateway instances&#10;4. Configure SSL/TLS certificates&#10;5. Use a service registry (Eureka, Consul) for dynamic service discovery&#10;6. Implement Redis for distributed rate limiting&#10;7. Set up centralized logging (ELK stack)&#10;8. Configure metrics collection (Prometheus/Grafana)&#10;&#10;### Docker Deployment&#10;Consider containerizing services with Docker for easier deployment and scaling." />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/api-gataway/pom.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/api-gataway/pom.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#10;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&#10;         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;&#10;    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;&#10;    &lt;parent&gt;&#10;        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;&#10;        &lt;version&gt;3.5.6&lt;/version&gt;&#10;        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;&#10;    &lt;/parent&gt;&#10;    &lt;groupId&gt;com.datnguyen.pe&lt;/groupId&gt;&#10;    &lt;artifactId&gt;api-gataway&lt;/artifactId&gt;&#10;    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;&#10;    &lt;name&gt;api-gataway&lt;/name&gt;&#10;    &lt;description&gt;api-gataway&lt;/description&gt;&#10;    &lt;url/&gt;&#10;    &lt;licenses&gt;&#10;        &lt;license/&gt;&#10;    &lt;/licenses&gt;&#10;    &lt;developers&gt;&#10;        &lt;developer/&gt;&#10;    &lt;/developers&gt;&#10;    &lt;scm&gt;&#10;        &lt;connection/&gt;&#10;        &lt;developerConnection/&gt;&#10;        &lt;tag/&gt;&#10;        &lt;url/&gt;&#10;    &lt;/scm&gt;&#10;    &lt;properties&gt;&#10;        &lt;java.version&gt;21&lt;/java.version&gt;&#10;        &lt;spring-cloud.version&gt;2025.0.0&lt;/spring-cloud.version&gt;&#10;    &lt;/properties&gt;&#10;    &lt;dependencies&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-cloud-starter-gateway-server-webflux&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;&#10;            &lt;artifactId&gt;lombok&lt;/artifactId&gt;&#10;            &lt;optional&gt;true&lt;/optional&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;&#10;            &lt;scope&gt;test&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;    &lt;/dependencies&gt;&#10;    &lt;dependencyManagement&gt;&#10;        &lt;dependencies&gt;&#10;            &lt;dependency&gt;&#10;                &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;&#10;                &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;&#10;                &lt;version&gt;${spring-cloud.version}&lt;/version&gt;&#10;                &lt;type&gt;pom&lt;/type&gt;&#10;                &lt;scope&gt;import&lt;/scope&gt;&#10;            &lt;/dependency&gt;&#10;        &lt;/dependencies&gt;&#10;    &lt;/dependencyManagement&gt;&#10;&#10;    &lt;build&gt;&#10;        &lt;plugins&gt;&#10;            &lt;plugin&gt;&#10;                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;&#10;                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;&#10;                &lt;configuration&gt;&#10;                    &lt;annotationProcessorPaths&gt;&#10;                        &lt;path&gt;&#10;                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;&#10;                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;&#10;                        &lt;/path&gt;&#10;                    &lt;/annotationProcessorPaths&gt;&#10;                &lt;/configuration&gt;&#10;            &lt;/plugin&gt;&#10;            &lt;plugin&gt;&#10;                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;&#10;                &lt;configuration&gt;&#10;                    &lt;excludes&gt;&#10;                        &lt;exclude&gt;&#10;                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;&#10;                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;&#10;                        &lt;/exclude&gt;&#10;                    &lt;/excludes&gt;&#10;                &lt;/configuration&gt;&#10;            &lt;/plugin&gt;&#10;        &lt;/plugins&gt;&#10;    &lt;/build&gt;&#10;&#10;&lt;/project&gt;&#10;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#10;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&#10;         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;&#10;    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;&#10;    &lt;parent&gt;&#10;        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;&#10;        &lt;version&gt;3.5.6&lt;/version&gt;&#10;        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;&#10;    &lt;/parent&gt;&#10;    &lt;groupId&gt;com.datnguyen.pe&lt;/groupId&gt;&#10;    &lt;artifactId&gt;api-gataway&lt;/artifactId&gt;&#10;    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;&#10;    &lt;name&gt;api-gataway&lt;/name&gt;&#10;    &lt;description&gt;api-gataway&lt;/description&gt;&#10;    &lt;url/&gt;&#10;    &lt;licenses&gt;&#10;        &lt;license/&gt;&#10;    &lt;/licenses&gt;&#10;    &lt;developers&gt;&#10;        &lt;developer/&gt;&#10;    &lt;/developers&gt;&#10;    &lt;scm&gt;&#10;        &lt;connection/&gt;&#10;        &lt;developerConnection/&gt;&#10;        &lt;tag/&gt;&#10;        &lt;url/&gt;&#10;    &lt;/scm&gt;&#10;    &lt;properties&gt;&#10;        &lt;java.version&gt;21&lt;/java.version&gt;&#10;        &lt;spring-cloud.version&gt;2025.0.0&lt;/spring-cloud.version&gt;&#10;    &lt;/properties&gt;&#10;    &lt;dependencies&gt;&#10;        &lt;!-- Spring Cloud Gateway --&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;&#10;        &lt;!-- Service Discovery (optional but recommended) --&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-cloud-starter-loadbalancer&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;&#10;        &lt;!-- Circuit Breaker for resilience --&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-cloud-starter-circuitbreaker-reactor-resilience4j&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;&#10;        &lt;!-- Actuator for monitoring --&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;&#10;        &lt;!-- JWT support for security --&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;&#10;            &lt;artifactId&gt;jjwt-api&lt;/artifactId&gt;&#10;            &lt;version&gt;0.11.5&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;&#10;            &lt;artifactId&gt;jjwt-impl&lt;/artifactId&gt;&#10;            &lt;version&gt;0.11.5&lt;/version&gt;&#10;            &lt;scope&gt;runtime&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;&#10;            &lt;artifactId&gt;jjwt-jackson&lt;/artifactId&gt;&#10;            &lt;version&gt;0.11.5&lt;/version&gt;&#10;            &lt;scope&gt;runtime&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;&#10;        &lt;!-- Swagger UI for API documentation --&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springdoc&lt;/groupId&gt;&#10;            &lt;artifactId&gt;springdoc-openapi-starter-webmvc-ui&lt;/artifactId&gt;&#10;            &lt;version&gt;2.8.5&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;&#10;        &lt;!-- Spring Boot Web for MVC endpoints --&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&#10;            &lt;exclusions&gt;&#10;                &lt;exclusion&gt;&#10;                    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;                    &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;&#10;                &lt;/exclusion&gt;&#10;            &lt;/exclusions&gt;&#10;        &lt;/dependency&gt;&#10;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;&#10;            &lt;artifactId&gt;lombok&lt;/artifactId&gt;&#10;            &lt;optional&gt;true&lt;/optional&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;&#10;            &lt;scope&gt;test&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;    &lt;/dependencies&gt;&#10;    &lt;dependencyManagement&gt;&#10;        &lt;dependencies&gt;&#10;            &lt;dependency&gt;&#10;                &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;&#10;                &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;&#10;                &lt;version&gt;${spring-cloud.version}&lt;/version&gt;&#10;                &lt;type&gt;pom&lt;/type&gt;&#10;                &lt;scope&gt;import&lt;/scope&gt;&#10;            &lt;/dependency&gt;&#10;        &lt;/dependencies&gt;&#10;    &lt;/dependencyManagement&gt;&#10;&#10;    &lt;build&gt;&#10;        &lt;plugins&gt;&#10;            &lt;plugin&gt;&#10;                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;&#10;                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;&#10;                &lt;configuration&gt;&#10;                    &lt;annotationProcessorPaths&gt;&#10;                        &lt;path&gt;&#10;                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;&#10;                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;&#10;                        &lt;/path&gt;&#10;                    &lt;/annotationProcessorPaths&gt;&#10;                &lt;/configuration&gt;&#10;            &lt;/plugin&gt;&#10;            &lt;plugin&gt;&#10;                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;&#10;                &lt;configuration&gt;&#10;                    &lt;excludes&gt;&#10;                        &lt;exclude&gt;&#10;                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;&#10;                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;&#10;                        &lt;/exclude&gt;&#10;                    &lt;/excludes&gt;&#10;                &lt;/configuration&gt;&#10;            &lt;/plugin&gt;&#10;        &lt;/plugins&gt;&#10;    &lt;/build&gt;&#10;&#10;&lt;/project&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/ApiGatawayApplication.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/ApiGatawayApplication.java" />
              <option name="originalContent" value="package com.datnguyen.pe.apigataway;&#10;&#10;import org.springframework.boot.SpringApplication;&#10;import org.springframework.boot.autoconfigure.SpringBootApplication;&#10;&#10;@SpringBootApplication&#10;public class ApiGatawayApplication {&#10;&#10;    public static void main(String[] args) {&#10;        SpringApplication.run(ApiGatawayApplication.class, args);&#10;    }&#10;&#10;}&#10;" />
              <option name="updatedContent" value="package com.datnguyen.pe.apigataway;&#10;&#10;import org.springframework.boot.SpringApplication;&#10;import org.springframework.boot.autoconfigure.SpringBootApplication;&#10;import org.springframework.cloud.circuitbreaker.resilience4j.ReactiveResilience4JCircuitBreakerFactory;&#10;import org.springframework.cloud.gateway.filter.ratelimit.KeyResolver;&#10;import org.springframework.context.annotation.Bean;&#10;import reactor.core.publisher.Mono;&#10;&#10;@SpringBootApplication&#10;public class ApiGatawayApplication {&#10;&#10;    public static void main(String[] args) {&#10;        SpringApplication.run(ApiGatawayApplication.class, args);&#10;    }&#10;&#10;    @Bean&#10;    public KeyResolver userKeyResolver() {&#10;        return exchange -&gt; {&#10;            String userId = exchange.getRequest().getHeaders().getFirst(&quot;X-User-Id&quot;);&#10;            if (userId != null) {&#10;                return Mono.just(userId);&#10;            }&#10;            // Fallback to IP address for rate limiting&#10;            String clientIp = exchange.getRequest().getRemoteAddress() != null ? &#10;                exchange.getRequest().getRemoteAddress().getAddress().getHostAddress() : &quot;unknown&quot;;&#10;            return Mono.just(clientIp);&#10;        };&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/config/CorsConfig.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/config/CorsConfig.java" />
              <option name="updatedContent" value="package com.datnguyen.pe.apigataway.config;&#10;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.context.annotation.Configuration;&#10;import org.springframework.web.cors.CorsConfiguration;&#10;import org.springframework.web.cors.reactive.CorsWebFilter;&#10;import org.springframework.web.cors.reactive.UrlBasedCorsConfigurationSource;&#10;&#10;import java.util.Arrays;&#10;import java.util.Collections;&#10;&#10;@Configuration&#10;public class CorsConfig {&#10;&#10;    @Bean&#10;    public CorsWebFilter corsWebFilter() {&#10;        CorsConfiguration corsConfig = new CorsConfiguration();&#10;        corsConfig.setAllowedOriginPatterns(Collections.singletonList(&quot;*&quot;));&#10;        corsConfig.setMaxAge(3600L);&#10;        corsConfig.setAllowedMethods(Arrays.asList(&quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;, &quot;OPTIONS&quot;));&#10;        corsConfig.setAllowedHeaders(Arrays.asList(&quot;*&quot;));&#10;        corsConfig.setAllowCredentials(true);&#10;&#10;        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();&#10;        source.registerCorsConfiguration(&quot;/**&quot;, corsConfig);&#10;&#10;        return new CorsWebFilter(source);&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/config/GatewayConfig.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/config/GatewayConfig.java" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="package com.datnguyen.pe.apigataway.config;&#10;&#10;import com.datnguyen.pe.apigataway.filter.JwtAuthenticationFilter;&#10;import org.springframework.cloud.gateway.route.RouteLocator;&#10;import org.springframework.cloud.gateway.route.builder.RouteLocatorBuilder;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.context.annotation.Configuration;&#10;&#10;@Configuration&#10;public class GatewayConfig {&#10;&#10;    private final JwtAuthenticationFilter jwtAuthenticationFilter;&#10;&#10;    public GatewayConfig(JwtAuthenticationFilter jwtAuthenticationFilter) {&#10;        this.jwtAuthenticationFilter = jwtAuthenticationFilter;&#10;    }&#10;&#10;    @Bean&#10;    public RouteLocator customRouteLocator(RouteLocatorBuilder builder) {&#10;        return builder.routes()&#10;                // IAM Service Routes with JWT authentication&#10;                .route(&quot;iam-service-auth&quot;, r -&gt; r&#10;                        .path(&quot;/api/auth/**&quot;)&#10;                        .filters(f -&gt; f&#10;                                .rewritePath(&quot;/api/(?&lt;segment&gt;.*)&quot;, &quot;/${segment}&quot;)&#10;                                .filter(jwtAuthenticationFilter.apply(new JwtAuthenticationFilter.Config()))&#10;                        )&#10;                        .uri(&quot;http://localhost:8081&quot;)&#10;                )&#10;                .route(&quot;iam-service-users&quot;, r -&gt; r&#10;                        .path(&quot;/api/users/**&quot;)&#10;                        .filters(f -&gt; f&#10;                                .rewritePath(&quot;/api/(?&lt;segment&gt;.*)&quot;, &quot;/${segment}&quot;)&#10;                                .filter(jwtAuthenticationFilter.apply(new JwtAuthenticationFilter.Config()))&#10;                        )&#10;                        .uri(&quot;http://localhost:8081&quot;)&#10;                )&#10;                .route(&quot;iam-service-password&quot;, r -&gt; r&#10;                        .path(&quot;/api/password-reset/**&quot;)&#10;                        .filters(f -&gt; f&#10;                                .rewritePath(&quot;/api/(?&lt;segment&gt;.*)&quot;, &quot;/${segment}&quot;)&#10;                                .filter(jwtAuthenticationFilter.apply(new JwtAuthenticationFilter.Config()))&#10;                        )&#10;                        .uri(&quot;http://localhost:8081&quot;)&#10;                )&#10;                // Patient Service Routes with JWT authentication&#10;                .route(&quot;patient-service-patients&quot;, r -&gt; r&#10;                        .path(&quot;/api/patients/**&quot;)&#10;                        .filters(f -&gt; f&#10;                                .rewritePath(&quot;/api/(?&lt;segment&gt;.*)&quot;, &quot;/${segment}&quot;)&#10;                                .filter(jwtAuthenticationFilter.apply(new JwtAuthenticationFilter.Config()))&#10;                        )&#10;                        .uri(&quot;http://localhost:8082&quot;)&#10;                )&#10;                .route(&quot;patient-service-appointments&quot;, r -&gt; r&#10;                        .path(&quot;/api/appointments/**&quot;)&#10;                        .filters(f -&gt; f&#10;                                .rewritePath(&quot;/api/(?&lt;segment&gt;.*)&quot;, &quot;/${segment}&quot;)&#10;                                .filter(jwtAuthenticationFilter.apply(new JwtAuthenticationFilter.Config()))&#10;                        )&#10;                        .uri(&quot;http://localhost:8082&quot;)&#10;                )&#10;                .route(&quot;patient-service-medical-records&quot;, r -&gt; r&#10;                        .path(&quot;/api/medical-records/**&quot;)&#10;                        .filters(f -&gt; f&#10;                                .rewritePath(&quot;/api/(?&lt;segment&gt;.*)&quot;, &quot;/${segment}&quot;)&#10;                                .filter(jwtAuthenticationFilter.apply(new JwtAuthenticationFilter.Config()))&#10;                        )&#10;                        .uri(&quot;http://localhost:8082&quot;)&#10;                )&#10;                // Health check route (no authentication needed)&#10;                .route(&quot;actuator&quot;, r -&gt; r&#10;                        .path(&quot;/actuator/**&quot;)&#10;                        .uri(&quot;http://localhost:8080&quot;)&#10;                )&#10;                .build();&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/config/SwaggerConfig.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/config/SwaggerConfig.java" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="package com.datnguyen.pe.apigataway.config;&#10;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.context.annotation.Configuration;&#10;import io.swagger.v3.oas.models.OpenAPI;&#10;import io.swagger.v3.oas.models.info.Info;&#10;import io.swagger.v3.oas.models.info.Contact;&#10;import io.swagger.v3.oas.models.servers.Server;&#10;&#10;import java.util.List;&#10;&#10;@Configuration&#10;public class SwaggerConfig {&#10;&#10;    @Bean&#10;    public OpenAPI customOpenAPI() {&#10;        return new OpenAPI()&#10;                .info(new Info()&#10;                        .title(&quot;HCM CPL Java Group 2 - API Gateway&quot;)&#10;                        .version(&quot;1.0.0&quot;)&#10;                        .description(&quot;API Gateway for Healthcare Management System - Aggregated Documentation&quot;)&#10;                        .contact(new Contact()&#10;                                .name(&quot;HCM CPL Java Group 2&quot;)&#10;                                .email(&quot;support@hcm-cpl.com&quot;)))&#10;                .servers(List.of(&#10;                        new Server().url(&quot;http://localhost:8080&quot;).description(&quot;API Gateway&quot;),&#10;                        new Server().url(&quot;http://localhost:8081&quot;).description(&quot;IAM Service&quot;), &#10;                        new Server().url(&quot;http://localhost:8082&quot;).description(&quot;Patient Service&quot;)&#10;                ));&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/config/WebClientConfig.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/config/WebClientConfig.java" />
              <option name="updatedContent" value="package com.datnguyen.pe.apigataway.config;&#10;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.context.annotation.Configuration;&#10;import org.springframework.web.reactive.function.client.WebClient;&#10;&#10;@Configuration&#10;public class WebClientConfig {&#10;&#10;    @Bean&#10;    public WebClient.Builder webClientBuilder() {&#10;        return WebClient.builder();&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/controller/FallbackController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/controller/FallbackController.java" />
              <option name="updatedContent" value="package com.datnguyen.pe.apigataway.controller;&#10;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.web.bind.annotation.GetMapping;&#10;import org.springframework.web.bind.annotation.PostMapping;&#10;import org.springframework.web.bind.annotation.RequestMapping;&#10;import org.springframework.web.bind.annotation.RestController;&#10;&#10;import java.time.LocalDateTime;&#10;import java.util.Map;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/fallback&quot;)&#10;public class FallbackController {&#10;&#10;    @GetMapping(&quot;/iam&quot;)&#10;    @PostMapping(&quot;/iam&quot;)&#10;    public ResponseEntity&lt;Map&lt;String, Object&gt;&gt; iamServiceFallback() {&#10;        return ResponseEntity.status(HttpStatus.SERVICE_UNAVAILABLE)&#10;                .body(Map.of(&#10;                        &quot;error&quot;, &quot;IAM Service Unavailable&quot;,&#10;                        &quot;message&quot;, &quot;The authentication service is temporarily unavailable. Please try again later.&quot;,&#10;                        &quot;timestamp&quot;, LocalDateTime.now(),&#10;                        &quot;status&quot;, HttpStatus.SERVICE_UNAVAILABLE.value()&#10;                ));&#10;    }&#10;&#10;    @GetMapping(&quot;/patient&quot;)&#10;    @PostMapping(&quot;/patient&quot;)&#10;    public ResponseEntity&lt;Map&lt;String, Object&gt;&gt; patientServiceFallback() {&#10;        return ResponseEntity.status(HttpStatus.SERVICE_UNAVAILABLE)&#10;                .body(Map.of(&#10;                        &quot;error&quot;, &quot;Patient Service Unavailable&quot;,&#10;                        &quot;message&quot;, &quot;The patient service is temporarily unavailable. Please try again later.&quot;,&#10;                        &quot;timestamp&quot;, LocalDateTime.now(),&#10;                        &quot;status&quot;, HttpStatus.SERVICE_UNAVAILABLE.value()&#10;                ));&#10;    }&#10;&#10;    @GetMapping(&quot;/default&quot;)&#10;    @PostMapping(&quot;/default&quot;)&#10;    public ResponseEntity&lt;Map&lt;String, Object&gt;&gt; defaultFallback() {&#10;        return ResponseEntity.status(HttpStatus.SERVICE_UNAVAILABLE)&#10;                .body(Map.of(&#10;                        &quot;error&quot;, &quot;Service Unavailable&quot;,&#10;                        &quot;message&quot;, &quot;The requested service is temporarily unavailable. Please try again later.&quot;,&#10;                        &quot;timestamp&quot;, LocalDateTime.now(),&#10;                        &quot;status&quot;, HttpStatus.SERVICE_UNAVAILABLE.value()&#10;                ));&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/controller/GatewayController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/controller/GatewayController.java" />
              <option name="updatedContent" value="package com.datnguyen.pe.apigataway.controller;&#10;&#10;import org.springframework.web.bind.annotation.GetMapping;&#10;import org.springframework.web.bind.annotation.RequestMapping;&#10;import org.springframework.web.bind.annotation.RestController;&#10;import reactor.core.publisher.Mono;&#10;&#10;import java.time.LocalDateTime;&#10;import java.util.Map;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/api/gateway&quot;)&#10;public class GatewayController {&#10;&#10;    @GetMapping(&quot;/info&quot;)&#10;    public Mono&lt;Map&lt;String, Object&gt;&gt; getGatewayInfo() {&#10;        return Mono.just(Map.of(&#10;                &quot;service&quot;, &quot;API Gateway&quot;,&#10;                &quot;version&quot;, &quot;1.0.0&quot;,&#10;                &quot;description&quot;, &quot;Healthcare Management System API Gateway&quot;,&#10;                &quot;timestamp&quot;, LocalDateTime.now(),&#10;                &quot;routes&quot;, Map.of(&#10;                        &quot;iam-service&quot;, &quot;http://localhost:8081&quot;,&#10;                        &quot;patient-service&quot;, &quot;http://localhost:8082&quot;&#10;                ),&#10;                &quot;documentation&quot;, Map.of(&#10;                        &quot;swagger-ui&quot;, &quot;/swagger-ui.html&quot;,&#10;                        &quot;api-docs&quot;, &quot;/v3/api-docs&quot;&#10;                )&#10;        ));&#10;    }&#10;&#10;    @GetMapping(&quot;/routes&quot;)&#10;    public Mono&lt;Map&lt;String, Object&gt;&gt; getRoutes() {&#10;        return Mono.just(Map.of(&#10;                &quot;routes&quot;, Map.of(&#10;                        &quot;iam-service&quot;, Map.of(&#10;                                &quot;url&quot;, &quot;http://localhost:8081&quot;,&#10;                                &quot;paths&quot;, new String[]{&quot;/api/auth/**&quot;, &quot;/api/users/**&quot;, &quot;/api/password-reset/**&quot;}&#10;                        ),&#10;                        &quot;patient-service&quot;, Map.of(&#10;                                &quot;url&quot;, &quot;http://localhost:8082&quot;, &#10;                                &quot;paths&quot;, new String[]{&quot;/api/patients/**&quot;, &quot;/api/appointments/**&quot;, &quot;/api/medical-records/**&quot;}&#10;                        )&#10;                )&#10;        ));&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/controller/HealthController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/controller/HealthController.java" />
              <option name="updatedContent" value="package com.datnguyen.pe.apigataway.controller;&#10;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.web.bind.annotation.GetMapping;&#10;import org.springframework.web.bind.annotation.RequestMapping;&#10;import org.springframework.web.bind.annotation.RestController;&#10;&#10;import java.time.LocalDateTime;&#10;import java.util.Map;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/health&quot;)&#10;public class HealthController {&#10;&#10;    @GetMapping&#10;    public ResponseEntity&lt;Map&lt;String, Object&gt;&gt; health() {&#10;        return ResponseEntity.ok(Map.of(&#10;                &quot;status&quot;, &quot;UP&quot;,&#10;                &quot;service&quot;, &quot;API Gateway&quot;,&#10;                &quot;timestamp&quot;, LocalDateTime.now(),&#10;                &quot;version&quot;, &quot;1.0.0&quot;&#10;        ));&#10;    }&#10;&#10;    @GetMapping(&quot;/gateway&quot;)&#10;    public ResponseEntity&lt;Map&lt;String, Object&gt;&gt; gatewayHealth() {&#10;        return ResponseEntity.ok(Map.of(&#10;                &quot;gateway&quot;, &quot;ACTIVE&quot;,&#10;                &quot;routes&quot;, Map.of(&#10;                        &quot;iam-service&quot;, &quot;http://localhost:8081&quot;,&#10;                        &quot;patient-service&quot;, &quot;http://localhost:8082&quot;&#10;                ),&#10;                &quot;timestamp&quot;, LocalDateTime.now()&#10;        ));&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/controller/SwaggerController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/controller/SwaggerController.java" />
              <option name="updatedContent" value="package com.datnguyen.pe.apigataway.controller;&#10;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.web.bind.annotation.GetMapping;&#10;import org.springframework.web.bind.annotation.PathVariable;&#10;import org.springframework.web.bind.annotation.RestController;&#10;import org.springframework.web.reactive.function.client.WebClient;&#10;import reactor.core.publisher.Mono;&#10;&#10;import java.util.ArrayList;&#10;import java.util.HashMap;&#10;import java.util.List;&#10;import java.util.Map;&#10;&#10;@RestController&#10;public class SwaggerController {&#10;&#10;    private final WebClient.Builder webClientBuilder;&#10;&#10;    public SwaggerController(WebClient.Builder webClientBuilder) {&#10;        this.webClientBuilder = webClientBuilder;&#10;    }&#10;&#10;    @GetMapping(&quot;/v3/api-docs&quot;)&#10;    public ResponseEntity&lt;Map&lt;String, Object&gt;&gt; getApiDocs() {&#10;        Map&lt;String, Object&gt; gatewayDocs = new HashMap&lt;&gt;();&#10;        gatewayDocs.put(&quot;openapi&quot;, &quot;3.0.1&quot;);&#10;        &#10;        Map&lt;String, Object&gt; info = new HashMap&lt;&gt;();&#10;        info.put(&quot;title&quot;, &quot;HCM CPL Java Group 2 - API Gateway&quot;);&#10;        info.put(&quot;version&quot;, &quot;1.0.0&quot;);&#10;        info.put(&quot;description&quot;, &quot;API Gateway Documentation - Use the service-specific endpoints for detailed API docs&quot;);&#10;        gatewayDocs.put(&quot;info&quot;, info);&#10;&#10;        List&lt;Map&lt;String, Object&gt;&gt; servers = new ArrayList&lt;&gt;();&#10;        Map&lt;String, Object&gt; server = new HashMap&lt;&gt;();&#10;        server.put(&quot;url&quot;, &quot;http://localhost:8080&quot;);&#10;        server.put(&quot;description&quot;, &quot;API Gateway Server&quot;);&#10;        servers.add(server);&#10;        gatewayDocs.put(&quot;servers&quot;, servers);&#10;&#10;        Map&lt;String, Object&gt; paths = new HashMap&lt;&gt;();&#10;        &#10;        // Gateway specific endpoints&#10;        Map&lt;String, Object&gt; healthPath = new HashMap&lt;&gt;();&#10;        Map&lt;String, Object&gt; healthGet = new HashMap&lt;&gt;();&#10;        healthGet.put(&quot;summary&quot;, &quot;Gateway Health Check&quot;);&#10;        healthGet.put(&quot;description&quot;, &quot;Check if the API Gateway is running&quot;);&#10;        Map&lt;String, Object&gt; healthResponse = new HashMap&lt;&gt;();&#10;        healthResponse.put(&quot;200&quot;, Map.of(&quot;description&quot;, &quot;Gateway is healthy&quot;));&#10;        healthGet.put(&quot;responses&quot;, healthResponse);&#10;        healthPath.put(&quot;get&quot;, healthGet);&#10;        paths.put(&quot;/health&quot;, healthPath);&#10;&#10;        Map&lt;String, Object&gt; routesPath = new HashMap&lt;&gt;();&#10;        Map&lt;String, Object&gt; routesGet = new HashMap&lt;&gt;();&#10;        routesGet.put(&quot;summary&quot;, &quot;Get Gateway Routes&quot;);&#10;        routesGet.put(&quot;description&quot;, &quot;List all configured routes in the API Gateway&quot;);&#10;        Map&lt;String, Object&gt; routesResponse = new HashMap&lt;&gt;();&#10;        routesResponse.put(&quot;200&quot;, Map.of(&quot;description&quot;, &quot;List of gateway routes&quot;));&#10;        routesGet.put(&quot;responses&quot;, routesResponse);&#10;        routesPath.put(&quot;get&quot;, routesGet);&#10;        paths.put(&quot;/api/gateway/routes&quot;, routesPath);&#10;&#10;        gatewayDocs.put(&quot;paths&quot;, paths);&#10;&#10;        return ResponseEntity.ok(gatewayDocs);&#10;    }&#10;&#10;    @GetMapping(&quot;/v3/api-docs/swagger-config&quot;)&#10;    public ResponseEntity&lt;Map&lt;String, Object&gt;&gt; getSwaggerConfig() {&#10;        Map&lt;String, Object&gt; config = new HashMap&lt;&gt;();&#10;        &#10;        List&lt;Map&lt;String, Object&gt;&gt; urls = new ArrayList&lt;&gt;();&#10;        &#10;        // Gateway docs&#10;        Map&lt;String, Object&gt; gatewayUrl = new HashMap&lt;&gt;();&#10;        gatewayUrl.put(&quot;url&quot;, &quot;/v3/api-docs&quot;);&#10;        gatewayUrl.put(&quot;name&quot;, &quot;API Gateway&quot;);&#10;        urls.add(gatewayUrl);&#10;        &#10;        // IAM Service docs&#10;        Map&lt;String, Object&gt; iamUrl = new HashMap&lt;&gt;();&#10;        iamUrl.put(&quot;url&quot;, &quot;http://localhost:8081/v3/api-docs&quot;);&#10;        iamUrl.put(&quot;name&quot;, &quot;IAM Service&quot;);&#10;        urls.add(iamUrl);&#10;        &#10;        // Patient Service docs  &#10;        Map&lt;String, Object&gt; patientUrl = new HashMap&lt;&gt;();&#10;        patientUrl.put(&quot;url&quot;, &quot;http://localhost:8082/v3/api-docs&quot;);&#10;        patientUrl.put(&quot;name&quot;, &quot;Patient Service&quot;);&#10;        urls.add(patientUrl);&#10;        &#10;        config.put(&quot;urls&quot;, urls);&#10;        config.put(&quot;deepLinking&quot;, true);&#10;        config.put(&quot;displayOperationId&quot;, false);&#10;        config.put(&quot;defaultModelsExpandDepth&quot;, 1);&#10;        config.put(&quot;defaultModelExpandDepth&quot;, 1);&#10;        config.put(&quot;defaultModelRendering&quot;, &quot;example&quot;);&#10;        config.put(&quot;displayRequestDuration&quot;, false);&#10;        config.put(&quot;docExpansion&quot;, &quot;none&quot;);&#10;        config.put(&quot;filter&quot;, false);&#10;        config.put(&quot;maxDisplayedTags&quot;, null);&#10;        config.put(&quot;operationsSorter&quot;, null);&#10;        config.put(&quot;showExtensions&quot;, false);&#10;        config.put(&quot;tagsSorter&quot;, null);&#10;        config.put(&quot;validatorUrl&quot;, &quot;&quot;);&#10;        config.put(&quot;oauth2RedirectUrl&quot;, &quot;http://localhost:8080/swagger-ui/oauth2-redirect.html&quot;);&#10;        &#10;        return ResponseEntity.ok(config);&#10;    }&#10;&#10;    @GetMapping(&quot;/swagger-resources&quot;)&#10;    public ResponseEntity&lt;List&lt;Map&lt;String, Object&gt;&gt;&gt; getSwaggerResources() {&#10;        List&lt;Map&lt;String, Object&gt;&gt; resources = new ArrayList&lt;&gt;();&#10;        &#10;        Map&lt;String, Object&gt; gateway = new HashMap&lt;&gt;();&#10;        gateway.put(&quot;name&quot;, &quot;API Gateway&quot;);&#10;        gateway.put(&quot;url&quot;, &quot;/v3/api-docs&quot;);&#10;        gateway.put(&quot;swaggerVersion&quot;, &quot;3.0.1&quot;);&#10;        gateway.put(&quot;location&quot;, &quot;/v3/api-docs&quot;);&#10;        resources.add(gateway);&#10;        &#10;        Map&lt;String, Object&gt; iam = new HashMap&lt;&gt;();&#10;        iam.put(&quot;name&quot;, &quot;IAM Service&quot;);&#10;        iam.put(&quot;url&quot;, &quot;http://localhost:8081/v3/api-docs&quot;);&#10;        iam.put(&quot;swaggerVersion&quot;, &quot;3.0.1&quot;);&#10;        iam.put(&quot;location&quot;, &quot;http://localhost:8081/v3/api-docs&quot;);&#10;        resources.add(iam);&#10;        &#10;        Map&lt;String, Object&gt; patient = new HashMap&lt;&gt;();&#10;        patient.put(&quot;name&quot;, &quot;Patient Service&quot;);&#10;        patient.put(&quot;url&quot;, &quot;http://localhost:8082/v3/api-docs&quot;);&#10;        patient.put(&quot;swaggerVersion&quot;, &quot;3.0.1&quot;);&#10;        patient.put(&quot;location&quot;, &quot;http://localhost:8082/v3/api-docs&quot;);&#10;        resources.add(patient);&#10;        &#10;        return ResponseEntity.ok(resources);&#10;    }&#10;&#10;    @GetMapping(&quot;/swagger-resources/configuration/ui&quot;)&#10;    public ResponseEntity&lt;Map&lt;String, Object&gt;&gt; getSwaggerUiConfig() {&#10;        Map&lt;String, Object&gt; config = new HashMap&lt;&gt;();&#10;        config.put(&quot;deepLinking&quot;, true);&#10;        config.put(&quot;displayOperationId&quot;, false);&#10;        config.put(&quot;defaultModelsExpandDepth&quot;, 1);&#10;        config.put(&quot;defaultModelExpandDepth&quot;, 1);&#10;        config.put(&quot;defaultModelRendering&quot;, &quot;example&quot;);&#10;        config.put(&quot;displayRequestDuration&quot;, false);&#10;        config.put(&quot;docExpansion&quot;, &quot;none&quot;);&#10;        config.put(&quot;filter&quot;, false);&#10;        config.put(&quot;operationsSorter&quot;, null);&#10;        config.put(&quot;showExtensions&quot;, false);&#10;        config.put(&quot;tagsSorter&quot;, null);&#10;        config.put(&quot;validatorUrl&quot;, &quot;&quot;);&#10;        return ResponseEntity.ok(config);&#10;    }&#10;&#10;    @GetMapping(&quot;/swagger-resources/configuration/security&quot;)&#10;    public ResponseEntity&lt;Map&lt;String, Object&gt;&gt; getSwaggerSecurityConfig() {&#10;        Map&lt;String, Object&gt; config = new HashMap&lt;&gt;();&#10;        config.put(&quot;clientId&quot;, null);&#10;        config.put(&quot;clientSecret&quot;, null);&#10;        config.put(&quot;realm&quot;, null);&#10;        config.put(&quot;appName&quot;, &quot;HCM CPL Java Group 2 - API Gateway&quot;);&#10;        config.put(&quot;scopeSeparator&quot;, &quot; &quot;);&#10;        config.put(&quot;additionalQueryStringParams&quot;, new HashMap&lt;&gt;());&#10;        config.put(&quot;useBasicAuthenticationWithAccessCodeGrant&quot;, false);&#10;        return ResponseEntity.ok(config);&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/exception/GlobalExceptionHandler.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/exception/GlobalExceptionHandler.java" />
              <option name="updatedContent" value="package com.datnguyen.pe.apigataway.exception;&#10;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.boot.web.reactive.error.ErrorWebExceptionHandler;&#10;import org.springframework.core.annotation.Order;&#10;import org.springframework.core.io.buffer.DataBuffer;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.http.MediaType;&#10;import org.springframework.http.server.reactive.ServerHttpResponse;&#10;import org.springframework.stereotype.Component;&#10;import org.springframework.web.server.ServerWebExchange;&#10;import reactor.core.publisher.Mono;&#10;&#10;import java.nio.charset.StandardCharsets;&#10;&#10;@Component&#10;@Order(-1)&#10;@Slf4j&#10;public class GlobalExceptionHandler implements ErrorWebExceptionHandler {&#10;&#10;    @Override&#10;    public Mono&lt;Void&gt; handle(ServerWebExchange exchange, Throwable ex) {&#10;        ServerHttpResponse response = exchange.getResponse();&#10;        &#10;        if (response.isCommitted()) {&#10;            return Mono.error(ex);&#10;        }&#10;&#10;        // Set content type&#10;        response.getHeaders().add(&quot;Content-Type&quot;, MediaType.APPLICATION_JSON_VALUE);&#10;&#10;        // Determine status and message based on exception type&#10;        HttpStatus status = HttpStatus.INTERNAL_SERVER_ERROR;&#10;        String message = &quot;Internal Server Error&quot;;&#10;&#10;        if (ex instanceof org.springframework.web.server.ResponseStatusException) {&#10;            org.springframework.web.server.ResponseStatusException responseStatusException = &#10;                (org.springframework.web.server.ResponseStatusException) ex;&#10;            status = HttpStatus.valueOf(responseStatusException.getStatusCode().value());&#10;            message = responseStatusException.getReason();&#10;        } else if (ex instanceof java.net.ConnectException) {&#10;            status = HttpStatus.SERVICE_UNAVAILABLE;&#10;            message = &quot;Service temporarily unavailable&quot;;&#10;        } else if (ex instanceof java.util.concurrent.TimeoutException) {&#10;            status = HttpStatus.GATEWAY_TIMEOUT;&#10;            message = &quot;Request timeout&quot;;&#10;        }&#10;&#10;        response.setStatusCode(status);&#10;&#10;        // Create error response body&#10;        String errorBody = String.format(&#10;            &quot;{\&quot;timestamp\&quot;: \&quot;%s\&quot;, \&quot;status\&quot;: %d, \&quot;error\&quot;: \&quot;%s\&quot;, \&quot;message\&quot;: \&quot;%s\&quot;, \&quot;path\&quot;: \&quot;%s\&quot;}&quot;,&#10;            java.time.Instant.now().toString(),&#10;            status.value(),&#10;            status.getReasonPhrase(),&#10;            message,&#10;            exchange.getRequest().getPath().value()&#10;        );&#10;&#10;        log.error(&quot;Gateway error: {} - {}&quot;, status, message, ex);&#10;&#10;        DataBuffer buffer = response.bufferFactory().wrap(errorBody.getBytes(StandardCharsets.UTF_8));&#10;        return response.writeWith(Mono.just(buffer));&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/filter/JwtAuthenticationFilter.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/filter/JwtAuthenticationFilter.java" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="package com.datnguyen.pe.apigataway.filter;&#10;&#10;import io.jsonwebtoken.Claims;&#10;import io.jsonwebtoken.Jwts;&#10;import io.jsonwebtoken.security.Keys;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.beans.factory.annotation.Value;&#10;import org.springframework.cloud.gateway.filter.GatewayFilter;&#10;import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;&#10;import org.springframework.http.HttpHeaders;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.http.server.reactive.ServerHttpRequest;&#10;import org.springframework.http.server.reactive.ServerHttpResponse;&#10;import org.springframework.stereotype.Component;&#10;import org.springframework.web.server.ServerWebExchange;&#10;import reactor.core.publisher.Mono;&#10;&#10;import javax.crypto.SecretKey;&#10;import java.nio.charset.StandardCharsets;&#10;import java.util.List;&#10;&#10;@Component&#10;@Slf4j&#10;public class JwtAuthenticationFilter extends AbstractGatewayFilterFactory&lt;JwtAuthenticationFilter.Config&gt; {&#10;&#10;    @Value(&quot;${jwt.secret:nXT5iZ/lPUY/9T4pgt3zqCJkezyP0if70mQbfJlz1k8=}&quot;)&#10;    private String jwtSecret;&#10;&#10;    // Routes that don't require authentication&#10;    private static final List&lt;String&gt; OPEN_API_ENDPOINTS = List.of(&#10;            &quot;/auth/login&quot;,&#10;            &quot;/auth/register&quot;,&#10;            &quot;/auth/refresh-token&quot;,&#10;            &quot;/auth/social&quot;,&#10;            &quot;/password-reset&quot;,&#10;            &quot;/actuator&quot;,&#10;            &quot;/swagger-ui&quot;,&#10;            &quot;/swagger-ui.html&quot;,&#10;            &quot;/webjars&quot;,&#10;            &quot;/v3/api-docs&quot;,&#10;            &quot;/iam-service/v3/api-docs&quot;,&#10;            &quot;/patient-service/v3/api-docs&quot;&#10;    );&#10;&#10;    public JwtAuthenticationFilter() {&#10;        super(Config.class);&#10;    }&#10;&#10;    @Override&#10;    public GatewayFilter apply(Config config) {&#10;        return (exchange, chain) -&gt; {&#10;            ServerHttpRequest request = exchange.getRequest();&#10;            String path = request.getURI().getPath();&#10;&#10;            // Skip authentication for open endpoints&#10;            if (isOpenApiEndpoint(path)) {&#10;                return chain.filter(exchange);&#10;            }&#10;&#10;            // Check for Authorization header&#10;            String authHeader = request.getHeaders().getFirst(HttpHeaders.AUTHORIZATION);&#10;            if (authHeader == null || !authHeader.startsWith(&quot;Bearer &quot;)) {&#10;                return onError(exchange, &quot;Missing or invalid Authorization header&quot;, HttpStatus.UNAUTHORIZED);&#10;            }&#10;&#10;            String token = authHeader.substring(7);&#10;&#10;            try {&#10;                // Validate JWT token&#10;                SecretKey key = Keys.hmacShaKeyFor(jwtSecret.getBytes(StandardCharsets.UTF_8));&#10;                Claims claims = Jwts.parserBuilder()&#10;                        .setSigningKey(key)&#10;                        .build()&#10;                        .parseClaimsJws(token)&#10;                        .getBody();&#10;&#10;                // Add user info to request headers for downstream services&#10;                ServerHttpRequest modifiedRequest = request.mutate()&#10;                        .header(&quot;X-User-Id&quot;, claims.getSubject())&#10;                        .header(&quot;X-User-Email&quot;, claims.get(&quot;email&quot;, String.class))&#10;                        .header(&quot;X-User-Role&quot;, claims.get(&quot;role&quot;, String.class))&#10;                        .build();&#10;&#10;                return chain.filter(exchange.mutate().request(modifiedRequest).build());&#10;&#10;            } catch (Exception e) {&#10;                log.error(&quot;JWT validation failed: {}&quot;, e.getMessage());&#10;                return onError(exchange, &quot;Invalid JWT token&quot;, HttpStatus.UNAUTHORIZED);&#10;            }&#10;        };&#10;    }&#10;&#10;    private boolean isOpenApiEndpoint(String path) {&#10;        return OPEN_API_ENDPOINTS.stream().anyMatch(path::startsWith);&#10;    }&#10;&#10;    private Mono&lt;Void&gt; onError(ServerWebExchange exchange, String message, HttpStatus status) {&#10;        ServerHttpResponse response = exchange.getResponse();&#10;        response.setStatusCode(status);&#10;        response.getHeaders().add(&quot;Content-Type&quot;, &quot;application/json&quot;);&#10;        String body = String.format(&quot;{\&quot;error\&quot;: \&quot;%s\&quot;, \&quot;status\&quot;: %d}&quot;, message, status.value());&#10;        return response.writeWith(Mono.just(response.bufferFactory().wrap(body.getBytes())));&#10;    }&#10;&#10;    public static class Config {&#10;        // Configuration properties if needed&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/filter/RateLimitingFilter.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/api-gataway/src/main/java/com/datnguyen/pe/apigataway/filter/RateLimitingFilter.java" />
              <option name="updatedContent" value="package com.datnguyen.pe.apigataway.filter;&#10;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.cloud.gateway.filter.GatewayFilter;&#10;import org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.http.server.reactive.ServerHttpResponse;&#10;import org.springframework.stereotype.Component;&#10;import org.springframework.web.server.ServerWebExchange;&#10;import reactor.core.publisher.Mono;&#10;&#10;import java.time.LocalDateTime;&#10;import java.util.concurrent.ConcurrentHashMap;&#10;import java.util.concurrent.atomic.AtomicInteger;&#10;&#10;@Component&#10;@Slf4j&#10;public class RateLimitingFilter extends AbstractGatewayFilterFactory&lt;RateLimitingFilter.Config&gt; {&#10;&#10;    private final ConcurrentHashMap&lt;String, UserRequestInfo&gt; userRequestMap = new ConcurrentHashMap&lt;&gt;();&#10;&#10;    public RateLimitingFilter() {&#10;        super(Config.class);&#10;    }&#10;&#10;    @Override&#10;    public GatewayFilter apply(Config config) {&#10;        return (exchange, chain) -&gt; {&#10;            String clientIp = getClientIp(exchange);&#10;            &#10;            UserRequestInfo requestInfo = userRequestMap.computeIfAbsent(clientIp, &#10;                k -&gt; new UserRequestInfo());&#10;&#10;            LocalDateTime now = LocalDateTime.now();&#10;            &#10;            // Reset counter if time window has passed&#10;            if (requestInfo.getWindowStart().plusMinutes(1).isBefore(now)) {&#10;                requestInfo.reset(now);&#10;            }&#10;&#10;            // Check if rate limit exceeded&#10;            if (requestInfo.getRequestCount().incrementAndGet() &gt; config.getMaxRequestsPerMinute()) {&#10;                return rateLimitExceeded(exchange);&#10;            }&#10;&#10;            return chain.filter(exchange);&#10;        };&#10;    }&#10;&#10;    private String getClientIp(ServerWebExchange exchange) {&#10;        String xForwardedFor = exchange.getRequest().getHeaders().getFirst(&quot;X-Forwarded-For&quot;);&#10;        if (xForwardedFor != null &amp;&amp; !xForwardedFor.isEmpty()) {&#10;            return xForwardedFor.split(&quot;,&quot;)[0];&#10;        }&#10;        &#10;        String xRealIp = exchange.getRequest().getHeaders().getFirst(&quot;X-Real-IP&quot;);&#10;        if (xRealIp != null &amp;&amp; !xRealIp.isEmpty()) {&#10;            return xRealIp;&#10;        }&#10;        &#10;        return exchange.getRequest().getRemoteAddress() != null ? &#10;            exchange.getRequest().getRemoteAddress().getAddress().getHostAddress() : &quot;unknown&quot;;&#10;    }&#10;&#10;    private Mono&lt;Void&gt; rateLimitExceeded(ServerWebExchange exchange) {&#10;        ServerHttpResponse response = exchange.getResponse();&#10;        response.setStatusCode(HttpStatus.TOO_MANY_REQUESTS);&#10;        response.getHeaders().add(&quot;Content-Type&quot;, &quot;application/json&quot;);&#10;        &#10;        String body = &quot;{\&quot;error\&quot;: \&quot;Rate limit exceeded\&quot;, \&quot;message\&quot;: \&quot;Too many requests, please try again later\&quot;}&quot;;&#10;        return response.writeWith(Mono.just(response.bufferFactory().wrap(body.getBytes())));&#10;    }&#10;&#10;    public static class Config {&#10;        private int maxRequestsPerMinute = 100; // Default 100 requests per minute&#10;&#10;        public int getMaxRequestsPerMinute() {&#10;            return maxRequestsPerMinute;&#10;        }&#10;&#10;        public void setMaxRequestsPerMinute(int maxRequestsPerMinute) {&#10;            this.maxRequestsPerMinute = maxRequestsPerMinute;&#10;        }&#10;    }&#10;&#10;    private static class UserRequestInfo {&#10;        private AtomicInteger requestCount = new AtomicInteger(0);&#10;        private LocalDateTime windowStart = LocalDateTime.now();&#10;&#10;        public AtomicInteger getRequestCount() {&#10;            return requestCount;&#10;        }&#10;&#10;        public LocalDateTime getWindowStart() {&#10;            return windowStart;&#10;        }&#10;&#10;        public void reset(LocalDateTime newWindowStart) {&#10;            this.requestCount.set(0);&#10;            this.windowStart = newWindowStart;&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/api-gataway/src/main/resources/application.yml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/api-gataway/src/main/resources/application.yml" />
              <option name="originalContent" value="server:&#10;  port: 6789&#10;&#10;spring:&#10;    application:&#10;      name: api-gataway&#10;&#10;&#10;&#10;&#10;&#10;" />
              <option name="updatedContent" value="server:&#10;  port: 8080&#10;&#10;spring:&#10;  application:&#10;    name: api-gateway&#10;  cloud:&#10;    gateway:&#10;      default-filters:&#10;        - DedupeResponseHeader=Access-Control-Allow-Credentials Access-Control-Allow-Origin&#10;        - name: RequestRateLimiter&#10;          args:&#10;            redis-rate-limiter.replenishRate: 100&#10;            redis-rate-limiter.burstCapacity: 200&#10;            redis-rate-limiter.requestedTokens: 1&#10;      globalcors:&#10;        corsConfigurations:&#10;          '[/**]':&#10;            allowedOriginPatterns: &quot;*&quot;&#10;            allowedMethods:&#10;              - GET&#10;              - POST&#10;              - PUT&#10;              - DELETE&#10;              - OPTIONS&#10;            allowedHeaders: &quot;*&quot;&#10;            allowCredentials: true&#10;      routes:&#10;        # IAM Service Routes&#10;        - id: iam-service&#10;          uri: http://localhost:8081&#10;          predicates:&#10;            - Path=/api/auth/**, /api/users/**, /api/password-reset/**&#10;          filters:&#10;            - RewritePath=/api/(?&lt;segment&gt;.*), /${segment}&#10;            - name: CircuitBreaker&#10;              args:&#10;                name: iam-service&#10;                fallbackUri: forward:/fallback/iam&#10;&#10;        # Patient Service Routes&#10;        - id: patient-service&#10;          uri: http://localhost:8082&#10;          predicates:&#10;            - Path=/api/patients/**, /api/appointments/**, /api/medical-records/**&#10;          filters:&#10;            - RewritePath=/api/(?&lt;segment&gt;.*), /${segment}&#10;            - name: CircuitBreaker&#10;              args:&#10;                name: patient-service&#10;                fallbackUri: forward:/fallback/patient&#10;&#10;        # IAM Service Swagger Documentation&#10;        - id: iam-service-swagger&#10;          uri: http://localhost:8081&#10;          predicates:&#10;            - Path=/iam-service/v3/api-docs/**&#10;          filters:&#10;            - RewritePath=/iam-service/v3/api-docs/(?&lt;path&gt;.*), /v3/api-docs/$\{path}&#10;&#10;        # Patient Service Swagger Documentation&#10;        - id: patient-service-swagger&#10;          uri: http://localhost:8082&#10;          predicates:&#10;            - Path=/patient-service/v3/api-docs/**&#10;          filters:&#10;            - RewritePath=/patient-service/v3/api-docs/(?&lt;path&gt;.*), /v3/api-docs/$\{path}&#10;&#10;# Swagger UI Configuration&#10;springdoc:&#10;  swagger-ui:&#10;    path: /swagger-ui.html&#10;    url: /v3/api-docs&#10;    config-url: /v3/api-docs/swagger-config&#10;    oauth2-redirect-url: /swagger-ui/oauth2-redirect.html&#10;    disable-swagger-default-url: true&#10;    enabled: true&#10;  api-docs:&#10;    path: /v3/api-docs&#10;    enabled: true&#10;  show-actuator: true&#10;&#10;# JWT Configuration&#10;jwt:&#10;  secret: nXT5iZ/lPUY/9T4pgt3zqCJkezyP0if70mQbfJlz1k8=&#10;&#10;# Circuit Breaker Configuration&#10;resilience4j:&#10;  circuitbreaker:&#10;    instances:&#10;      iam-service:&#10;        registerHealthIndicator: true&#10;        slidingWindowSize: 10&#10;        minimumNumberOfCalls: 5&#10;        permittedNumberOfCallsInHalfOpenState: 3&#10;        automaticTransitionFromOpenToHalfOpenEnabled: true&#10;        waitDurationInOpenState: 5s&#10;        failureRateThreshold: 50&#10;        eventConsumerBufferSize: 10&#10;      patient-service:&#10;        registerHealthIndicator: true&#10;        slidingWindowSize: 10&#10;        minimumNumberOfCalls: 5&#10;        permittedNumberOfCallsInHalfOpenState: 3&#10;        automaticTransitionFromOpenToHalfOpenEnabled: true&#10;        waitDurationInOpenState: 5s&#10;        failureRateThreshold: 50&#10;        eventConsumerBufferSize: 10&#10;&#10;# Actuator Configuration for monitoring&#10;management:&#10;  endpoints:&#10;    web:&#10;      exposure:&#10;        include: health,info,metrics,gateway&#10;  endpoint:&#10;    health:&#10;      show-details: always&#10;  health:&#10;    circuitbreakers:&#10;      enabled: true&#10;&#10;logging:&#10;  level:&#10;    org.springframework.cloud.gateway: DEBUG&#10;    org.springframework.web.cors: DEBUG&#10;    com.datnguyen.pe.apigataway: DEBUG" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/testorder-services/src/main/resources/application.yml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/testorder-services/src/main/resources/application.yml" />
              <option name="originalContent" value="spring:&#10;  application:&#10;    name: testorder-service&#10;&#10;  datasource:&#10;    url: jdbc:mysql://localhost:3306/TestOrder_Service&#10;    username: root&#10;    password: 123456&#10;    driver-class-name: com.mysql.cj.jdbc.Driver&#10;&#10;  jpa:&#10;    hibernate:&#10;      ddl-auto: update&#10;    show-sql: true&#10;    properties:&#10;      hibernate:&#10;        format_sql: true&#10;&#10;server:&#10;  port: 8083&#10;&#10;app:&#10;  patient-service:&#10;    url: http://localhost:8082&#10;  user-service:&#10;    url: http://localhost:8081/iam&#10;&#10;springdoc:&#10;  swagger-ui:&#10;    enabled: true&#10;  api-docs:&#10;    enabled: true&#10;&#10;eureka:&#10;  client:&#10;    service-url:&#10;      defaultZone: http://localhost:8761/eureka/&#10;  instance:&#10;    hostname: localhost&#10;&#10;management:&#10;  endpoints:&#10;    web:&#10;      exposure:&#10;        include: &quot;*&quot;&#10;  tracing:&#10;    sampling:&#10;      probability: 1.0&#10;  zipkin:&#10;    tracing:&#10;      endpoint: http://localhost:9411/api/v2/spans&#10;" />
              <option name="updatedContent" value="spring:&#10;  application:&#10;    name: testorder-service&#10;&#10;  datasource:&#10;    url: jdbc:mysql://localhost:3306/TestOrder_Service&#10;    username: root&#10;    password: 123456&#10;    driver-class-name: com.mysql.cj.jdbc.Driver&#10;&#10;  jpa:&#10;    hibernate:&#10;      ddl-auto: update&#10;    show-sql: true&#10;    properties:&#10;      hibernate:&#10;        format_sql: true&#10;&#10;  autoconfigure:&#10;    exclude:&#10;      - org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration&#10;&#10;server:&#10;  port: 8083&#10;&#10;app:&#10;  patient-service:&#10;    url: http://localhost:8082&#10;  user-service:&#10;    url: http://localhost:8081/iam&#10;&#10;springdoc:&#10;  swagger-ui:&#10;    enabled: true&#10;  api-docs:&#10;    enabled: true&#10;&#10;eureka:&#10;  client:&#10;    service-url:&#10;      defaultZone: http://localhost:8761/eureka/&#10;  instance:&#10;    hostname: localhost&#10;&#10;management:&#10;  endpoints:&#10;    web:&#10;      exposure:&#10;        include: &quot;*&quot;&#10;  tracing:&#10;    sampling:&#10;      probability: 1.0&#10;  zipkin:&#10;    tracing:&#10;      endpoint: http://localhost:9411/api/v2/spans&#10;  health:&#10;    rabbit:&#10;      enabled: false" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/warehouse-service/src/main/resources/application.yml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/warehouse-service/src/main/resources/application.yml" />
              <option name="originalContent" value="server:&#10;  port: 8084&#10;&#10;spring:&#10;  application:&#10;    name: warehouse-service&#10;  datasource:&#10;    url: jdbc:postgresql://localhost:5432/warehouse_db&#10;    username: postgres&#10;    password: 123456&#10;    driver-class-name: org.postgresql.Driver&#10;  jpa:&#10;    hibernate:&#10;      ddl-auto: update&#10;    show-sql: true&#10;    properties:&#10;      hibernate:&#10;        dialect: org.hibernate.dialect.PostgreSQLDialect&#10;        format_sql: true&#10;&#10;eureka:&#10;  client:&#10;    service-url:&#10;      defaultZone: http://localhost:8761/eureka/&#10;  instance:&#10;    hostname: localhost&#10;&#10;&#10;&#10;management:&#10;  endpoints:&#10;    web:&#10;      exposure:&#10;        include: &quot;*&quot;&#10;  tracing:&#10;    sampling:&#10;      probability: 1.0 # 100% request c tracking (nu h thng ln, c th gim xung 0.5)&#10;  zipkin:&#10;    tracing:&#10;      endpoint: http://localhost:9411/api/v2/spans&#10;&#10;" />
              <option name="updatedContent" value="server:&#13;&#10;  port: 8084&#13;&#10;&#13;&#10;spring:&#13;&#10;  application:&#13;&#10;    name: warehouse-service&#13;&#10;  datasource:&#13;&#10;    url: jdbc:postgresql://localhost:5432/warehouse_db&#13;&#10;    username: postgres&#13;&#10;    password: 123456&#13;&#10;    driver-class-name: org.postgresql.Driver&#13;&#10;  jpa:&#13;&#10;    hibernate:&#13;&#10;      ddl-auto: update&#13;&#10;    show-sql: true&#13;&#10;    properties:&#13;&#10;      hibernate:&#13;&#10;        dialect: org.hibernate.dialect.PostgreSQLDialect&#13;&#10;        format_sql: true&#13;&#10;  &#13;&#10;  autoconfigure:&#13;&#10;    exclude:&#13;&#10;      - org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration&#13;&#10;&#13;&#10;eureka:&#13;&#10;  client:&#13;&#10;    service-url:&#13;&#10;      defaultZone: http://localhost:8761/eureka/&#13;&#10;  instance:&#13;&#10;    hostname: localhost&#13;&#10;&#13;&#10;management:&#13;&#10;  endpoints:&#13;&#10;    web:&#13;&#10;      exposure:&#13;&#10;        include: &quot;*&quot;&#13;&#10;  tracing:&#13;&#10;    sampling:&#13;&#10;      probability: 1.0 # 100% request c tracking (nu h thng ln, c th gim xung 0.5)&#13;&#10;  zipkin:&#13;&#10;    tracing:&#13;&#10;      endpoint: http://localhost:9411/api/v2/spans&#13;&#10;  health:&#13;&#10;    rabbit:&#13;&#10;      enabled: false" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>